{"version":3,"sources":["../Main.js"],"names":["Main","canvas","document","getElementById","ctx","getContext","dataStore","getInstance","loader","create","onLoaded","onResourceFirstLoaded","map","res","director","init","isGameOver","put","registerEvent","createPencil","run","addEventListener","e","preventDefault","birdsEvent"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;IAEaA,I,WAAAA,I;AAET,oBAAa;AAAA;;AAAA;;AACT,aAAKC,MAAL,GAAcC,SAASC,cAAT,CAAwB,QAAxB,CAAd;AACA,aAAKC,GAAL,GAAW,KAAKH,MAAL,CAAYI,UAAZ,CAAuB,IAAvB,CAAX;AACA,aAAKC,SAAL,GAAiB,qBAAUC,WAAV,EAAjB;AACA,YAAMC,SAAS,+BAAeC,MAAf,EAAf;AACAD,eAAOE,QAAP,CAAgB;AAAA,mBAAK,MAAKC,qBAAL,CAA2BC,GAA3B,CAAL;AAAA,SAAhB;AAGH;;AAED;;;;;;;;8CAIsBA,G,EAAI;AACtB,iBAAKN,SAAL,CAAeF,GAAf,GAAqB,KAAKA,GAA1B;AACA,iBAAKE,SAAL,CAAeO,GAAf,GAAqBD,GAArB;AACA,iBAAKE,QAAL,GAAgB,mBAASP,WAAT,EAAhB;AACA,iBAAKQ,IAAL;AACH;;;+BAEK;;AAEF;AACA,iBAAKD,QAAL,CAAcE,UAAd,GAA2B,KAA3B;AACA;AACA,iBAAKV,SAAL,CACKW,GADL,CACS,SADT,EACmB,EADnB,EAEKA,GAFL,CAES,YAFT,0BAGKA,GAHL,CAGS,MAHT,cAIKA,GAJL,CAIS,OAJT;;AAMA,iBAAKC,aAAL;;AAEA,iBAAKJ,QAAL,CAAcK,YAAd;AACA,iBAAKL,QAAL,CAAcM,GAAd;AAEH;;;wCAEc;AAAA;;AACX,iBAAKnB,MAAL,CAAYoB,gBAAZ,CAA6B,YAA7B,EAA0C,aAAG;AACzCC,kBAAEC,cAAF;AACA,oBAAG,OAAKT,QAAL,CAAcE,UAAjB,EAA4B;AACxB,2BAAKD,IAAL;AACH,iBAFD,MAEK;AACD,2BAAKD,QAAL,CAAcU,UAAd;AACH;AACJ,aAPD;AAQH","file":"Main.js","sourcesContent":["import {ResourceLoader} from \"./js/base/ResourceLoader.js\";\r\nimport {Background} from \"./js/runtime/Background.js\";\r\nimport {DataStore} from \"./js/base/DataStore.js\";\r\nimport {Director} from \"./js/Director.js\";\r\nimport {Land} from \"./js/runtime/Land.js\";\r\nimport {Birds} from \"./js/player/Birds.js\";\r\n\r\nexport class Main{\r\n\r\n    constructor(){\r\n        this.canvas = document.getElementById('canvas');\r\n        this.ctx = this.canvas.getContext('2d');\r\n        this.dataStore = DataStore.getInstance();\r\n        const loader = ResourceLoader.create();\r\n        loader.onLoaded(map=>this.onResourceFirstLoaded(map));\r\n\r\n\r\n    }\r\n\r\n    /**\r\n     * 资源第一次加载 将数据放入dataStore\r\n     * @param map=>需要加载的图片资源\r\n     */\r\n    onResourceFirstLoaded(map){\r\n        this.dataStore.ctx = this.ctx;\r\n        this.dataStore.res = map;\r\n        this.director = Director.getInstance();\r\n        this.init();\r\n    }\r\n\r\n    init(){\r\n\r\n        //游戏是否结束\r\n        this.director.isGameOver = false;\r\n        //把类的实例存入dataStore\r\n        this.dataStore\r\n            .put('pencils',[])\r\n            .put('background', Background)\r\n            .put('Land',Land)\r\n            .put('birds',Birds);\r\n\r\n        this.registerEvent();\r\n\r\n        this.director.createPencil();\r\n        this.director.run();\r\n\r\n    }\r\n\r\n    registerEvent(){\r\n        this.canvas.addEventListener('touchstart',e=>{\r\n            e.preventDefault();\r\n            if(this.director.isGameOver){\r\n                this.init();\r\n            }else{\r\n                this.director.birdsEvent();\r\n            }\r\n        });\r\n    }\r\n}"]}